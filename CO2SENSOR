Function co2requirement(area As Double, energyrecovery As String, climateZone As String, occupant_airflow As Double)

Application.Volatile

    Dim co2required As String
    If energyrecovery = "yes" Then
        If area < 200 Then
            If occupant_airflow < Application.WorksheetFunction.VLookup(climateZone, "DCV_noEArecovery[#All]", 2) Then
                co2required = "YES"
            End If
        
        ElseIf area < 399 Then
                If occupant_airflow < Application.WorksheetFunction.VLookup(climateZone, "DCV_noEArecovery[#All]", 3) Then
                    co2required = "YES"
                End If
        
        Else
                If occupant_airflow < Application.WorksheetFunction.VLookup(climateZone, "DCV_noEArecovery[#All]", 4) Then
                    co2required = "YES"
                    
                End If
    Else
   
        If area < 200 Then
            If occupant_airflow < Application.WorksheetFunction.VLookup(climateZone, "DCV_EARecovery[#All]", 2) Then
                co2required = "YES"
            End If
            
        ElseIf area < 399 Then
            If occupant_airflow < Application.WorksheetFunction.VLookup(climateZone, "DCV_EARecovery[#All]", 3) Then
                co2required = "YES"
            End If
        
        Else
            If occupant_airflow < Application.WorksheetFunction.VLookup(climateZone, "DCV_EARecovery[#All]", 4) Then
                co2required = "YES"
                
            End If
    End If
    
    co2requirement = co2required

End Function
