Function co2requirement(area As Double, energyrecovery As String, climateZone As String, occupant_airflow As Double)

Application.Volatile

    Dim co2required As String
    If energyrecovery = "yes" Then
        If area < 200 Then
            If occupant_airflow < Application.WorksheetFunction.VLookup(climateZone, "'ASHRAE Table'!Y3:AB21", 2, False) Then
                co2required = "YES"
            End If
        
        ElseIf area < 399 Then
                If occupant_airflow < Application.WorksheetFunction.VLookup(climateZone, "'ASHRAE Table'!Y3:AB21", 3, False) Then
                    co2required = "YES"
                End If
        
        Else
                If occupant_airflow < Application.WorksheetFunction.VLookup(climateZone, "'ASHRAE Table'!Y3:AB21", 4, False) Then
                    co2required = "YES"
                    
                End If
    Else
   
        If area < 200 Then
            If occupant_airflow < Application.WorksheetFunction.VLookup(climateZone, "'ASHRAE Table'!U3:X21", 2, False) Then
                co2required = "YES"
            End If
            
        ElseIf area < 399 Then
            If occupant_airflow < Application.WorksheetFunction.VLookup(climateZone, "'ASHRAE Table'!U3:X21", 3, False) Then
                co2required = "YES"
            End If
        
        Else
            If occupant_airflow < Application.WorksheetFunction.VLookup(climateZone, "'ASHRAE Table'!U3:X21", 4, False) Then
                co2required = "YES"
                
            End If
    End If
    
    co2requirement = co2required

End Function
